{"version":3,"sources":["components/Word/index.module.scss","components/SuggestionPopup/index.module.scss","stores/index.js","components/Word/index.js","components/SuggestionPopup/index.js","hooks/useOuterClick.js","components/ReplacementInput/index.js","components/Line/index.js","App.js","reportWebVitals.js","stores/LyricsStore.js","stores/SelectionStore.js","index.js","components/ReplacementInput/index.module.scss","components/Line/index.module.scss"],"names":["module","exports","StoreContext","React","createContext","StoreProvider","children","store","Provider","value","useStores","useContext","createSelectable","observer","selectableRef","isSelecting","isSelected","wordData","selectionStore","isActive","_","find","selections","id","className","syllable","ref","styles","word","style","backgroundColor","onClose","nextWord","prevWord","lyricsStore","useState","words","setWords","useEffect","length","tones","map","d","similiarTone","join","results","Object","values","data","filter","prefixSelection","char","characters","console","log","indexOf","postfixSelection","innerRef","callback","callbackRef","useRef","current","document","addEventListener","handleClick","removeEventListener","e","contains","target","useOuterClick","ev","suggestions","padding","openPopUp","setOpenPopUp","isFirstActive","get","isPrefixSelected","isPostfixSelected","container","height","inputContainer","type","replacement","size","input","onChange","updateReplacement","btnPrefixSuggestion","onClick","selectPostfix","btnPostfixSuggestion","selectPrefix","removeSelections","line","sentence","si","arr","resetOnStart","onSelectionFinish","val","setSelections","v","toJS","props","sort","a","b","index","globalMouse","allowClickWithoutSelected","position","left","top","width","zIndex","i","undefined","visibility","separator","tab","setTab","fetch","then","res","json","setData","flex","entries","original","import","export","usual","key","label","rel","href","setOriginal","setReplacement","readOnly","exportReplacement","placeholder","usualWords","setUsualWords","transformed","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","dummyOriginal","LyricsStore","transformedReplacement","makeObservable","this","observable","action","computed","lines","split","lineIndex","sentenceIndex","reduce","acc","wordIndex","test","push","tone9","replacementSyllable","replacementsimiliarTone","trim","SelectionStore","wordDatas","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.ff565701.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"syllable\":\"Word_syllable__2Nldw\",\"word\":\"Word_word__3tnqe\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"suggestions\":\"SuggestionPopup_suggestions__2_x13\"};","import React from 'react';\n\nconst StoreContext = React.createContext();\n\nexport const StoreProvider = ({ children, store }) => {\n  return (\n    <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\n  );\n};\n\n/* Hook to use store in any functional component */\nexport const useStores = () => React.useContext(StoreContext);\n\n/* HOC to inject store to any functional or class component */\nexport const withStore = (Component) => (props) => {\n  return <Component {...props} store={useStores()} />;\n};\n\n","import React from 'react';\nimport styles from './index.module.scss';\nimport { createSelectable } from 'react-selectable-fast'\nimport { useStores } from '../../stores';\nimport _ from 'lodash';\nimport { observer } from \"mobx-react\";\n\nconst Word = ({ selectableRef, isSelected, isSelecting, wordData }) => {\n  const { selectionStore } = useStores();\n\n  const isActive = _.find(selectionStore.selections, { id: wordData.id });\n\n  return (\n    <div className={`inline-block ${!wordData.syllable && \"not-selectable\"}`} ref={selectableRef} >\n      {wordData.syllable &&\n        <small className={styles.syllable}>\n          {wordData.syllable}\n        </small>}\n      <div\n        className={styles.word}\n        style={{\n          backgroundColor: isActive || isSelecting ? 'lightblue' : 'transparent'\n        }}\n      >\n        {wordData.word}\n      </div>\n    </div>\n  );\n};\n\nexport default createSelectable(observer(Word));\n","import React, { useEffect, useState } from 'react';\nimport styles from './index.module.scss';\nimport _ from 'lodash';\nimport useOuterClick from '../../hooks/useOuterClick';\nimport { useStores } from '../../stores';\nimport { observer } from \"mobx-react\";\n\nconst SuggestionPopup = ({ onClose, nextWord, prevWord }) => {\n  const { selectionStore, lyricsStore } = useStores();\n  const [ words, setWords ] = useState([]);\n\n  useEffect(() => {\n    if (!selectionStore.selections.length) return;\n    const tones = selectionStore.selections.map(d => d.similiarTone).join(',');\n    const results = Object.values(lyricsStore.data.words).filter(d => d.similiarTone === tones).map(d => d.words);\n    setWords(results);\n  }, [selectionStore.selections]);\n\n  useEffect(() => {\n    if (!selectionStore.prefixSelection) return;\n    const char = lyricsStore.data.characters[selectionStore.prefixSelection.word];\n    if (!char) {\n      setWords([]);\n      return;\n    }\n    const tones = [char.similiarTone, nextWord.similiarTone].join(',');\n    console.log(char.words)\n    const results = char.words\n      .filter(d => d.words.indexOf(selectionStore.prefixSelection.word) === 0)\n      .filter(d => d.similiarTone === tones).map(d => d.words);\n    setWords(results);\n\n  }, [selectionStore.prefixSelection])\n\n  useEffect(() => {\n    if (!selectionStore.postfixSelection) return;\n    const char = lyricsStore.data.characters[selectionStore.postfixSelection.word];\n    if (!char) {\n      setWords([]);\n      return;\n    }\n    const tones = [prevWord.similiarTone, char.similiarTone].join(',');\n    console.log(char.words)\n    const results = char.words\n      .filter(d => d.words.indexOf(selectionStore.postfixSelection.word) === d.words.length - 1)\n      .filter(d => d.similiarTone === tones).map(d => d.words);\n    setWords(results);\n\n  }, [selectionStore.postfixSelection])\n\n  const innerRef = useOuterClick(ev => {\n    onClose();\n  });\n\n  return (\n\n    <div ref={innerRef} className={styles.suggestions}>\n    {(words || []).map(words => (\n      <button style={{ padding: '1px 3px'}}>\n        <small>{words}</small>\n      </button>\n    ))}\n  </div>\n\n  );\n}\nexport default observer(SuggestionPopup);\n","import { useEffect, useRef } from 'react';\n\nexport default function useOuterClick(callback) {\n  const callbackRef = useRef(); // initialize mutable callback ref\n  const innerRef = useRef(); // returned to client, who sets the \"border\" element\n\n  // update callback on each render, so second useEffect has most recent callback\n  useEffect(() => { callbackRef.current = callback; });\n  useEffect(() => {\n    document.addEventListener(\"mousedown\", handleClick);\n    return () => document.removeEventListener(\"mousedown\", handleClick);\n    function handleClick(e) {\n      if (innerRef.current && callbackRef.current &&\n        !innerRef.current.contains(e.target)\n      ) callbackRef.current(e);\n    }\n  }, []); // no dependencies -> stable click listener\n\n  return innerRef; // convenience for client (doesn't need to init ref himself)\n}\n","import React, { useState, useEffect } from 'react';\nimport styles from './index.module.scss';\nimport { useStores } from '../../stores';\nimport _ from 'lodash';\nimport { observer } from \"mobx-react\";\nimport SuggestionPopup from '../SuggestionPopup';\n\n\n\nconst ReplacementInput = ({ wordData, nextWord, prevWord }) => {\n  const { selectionStore, lyricsStore } = useStores();\n  const [ openPopUp, setOpenPopUp ] = useState(false);\n\n  const isFirstActive = selectionStore.selections.length && _.get(selectionStore.selections, '0.id') === wordData.id;\n  const isPrefixSelected = selectionStore.prefixSelection && selectionStore.prefixSelection.id === wordData.id;\n  const isPostfixSelected = selectionStore.postfixSelection && selectionStore.postfixSelection.id === wordData.id;\n\n  useEffect(() => {\n    if (isFirstActive || isPrefixSelected || isPostfixSelected) {\n      setOpenPopUp(true);\n\n    } else {\n      setOpenPopUp(false);\n    }\n  }, [\n    isFirstActive,\n    isPrefixSelected,\n    isPostfixSelected,\n  ]);\n  const onClose = () => {\n    setOpenPopUp(false);\n    selectionStore.removeSelections();\n  }\n\n\n  return (\n\n      <div className={styles.container}>\n        {false && <div className={styles.selector} >\n          <small className=\"block\">{wordData.replacementSyllable}</small>\n        </div>}\n        <div style={{ height: 10}} />\n        <div className={styles.inputContainer}>\n          <input\n            type=\"text\"\n            value={wordData.replacement}\n            size=\"1\"\n            className={styles.input}\n            onChange={(e) => lyricsStore.updateReplacement(wordData, e.target.value)}\n          />\n\n        {!!wordData.replacement && <button\n          type=\"button\"\n          className={styles.btnPrefixSuggestion}\n          onClick={() => selectionStore.selectPostfix(wordData)}\n        />}\n        {!!wordData.replacement && <button\n          type=\"button\"\n          className={styles.btnPostfixSuggestion}\n          onClick={() => selectionStore.selectPrefix(wordData)}\n        />}\n                </div>\n\n        {openPopUp &&\n          <SuggestionPopup onClose={onClose} nextWord={nextWord} prevWord={prevWord}/>\n        }\n      </div>\n\n  );\n}\nexport default observer(ReplacementInput);\n","import React from 'react';\nimport styles from './index.module.scss';\nimport Word from '../Word';\nimport ReplacementInput from '../ReplacementInput';\nimport { SelectableGroup } from 'react-selectable-fast'\nimport { useStores } from '../../stores';\nimport { toJS } from 'mobx';\nimport { observer } from \"mobx-react\";\n\n\nconst Line = ({ line }) => {\n  const { selectionStore } = useStores();\n  return (\n    <div className={styles.line}>\n      {line.children.map((sentence, si, arr) => (\n        <div className={styles.line} key={`sen-${si}`}>\n          <div className={styles.line}>\n            <SelectableGroup\n              resetOnStart\n              onSelectionFinish={(val) => {\n                console.log(val);\n                selectionStore.setSelections(val.map(v => toJS(v.props.wordData)).sort((a, b) => a.index - b.index));\n              }}\n              // ignoreList={['.not-selectable']}\n              globalMouse={false}\n              allowClickWithoutSelected\n            >\n              <div style={{ position: 'absolute', left: 0, top: 0, width: '100%', zIndex: 2 }}\n                className=\"inline-block\"\n              >\n                {sentence.children.map((wordData) => (\n                  <div key={`word-${wordData.id}`}\n                    className=\"inline-block\">\n                    <Word wordData={wordData} />\n                  </div>\n                ))}\n              </div>\n            </SelectableGroup>\n            {sentence.children.map((wordData, i, arr) => {\n              const nextWord = i > 0 ? arr[i + 1] : undefined;\n              const prevWord = i < arr.length - 1 ? arr[i - 1] : undefined;\n              return (\n                <div key={`word-${wordData.id}`} className=\"inline-block\">\n                  <div style={{ visibility: 'hidden'}}><Word wordData={wordData} /></div>\n                  <ReplacementInput wordData={wordData}\n                    nextWord={nextWord}\n                    prevWord={prevWord}\n                  />\n                </div>\n              );\n            })}\n          </div>\n          {arr.length - 1 > si && <div className={styles.separator} />}\n        </div>))}\n    </div>\n  );\n}\n\nexport default observer(Line);\n","import React, { useState, useEffect } from 'react';\nimport './App.css';\n// import 'reset-css';\nimport Line from './components/Line';\nimport { useStores } from \"./stores\";\nimport { observer } from \"mobx-react\";\n\n\n\nfunction App() {\n  const { lyricsStore } = useStores();\n  const [tab, setTab] = useState('original');\n\n\n  useEffect(() => {\n    fetch('https://demo-328sd82.s3-ap-southeast-1.amazonaws.com/data.json')\n      .then((res) => res.json())\n      .then((data) => {\n        lyricsStore.setData(data);\n      });\n  }, []);\n\n  const tabOptions = {\n    original: '原詞',\n    import: '匯入',\n    export: '匯出',\n    usual: '常用',\n  }\n  return (\n    <div className=\"App\">\n      <header>\n        <div style={{ flex: 1 }}>\n          {Object.entries(tabOptions).map(([key, label]) => (\n            <button\n              key={key}\n              type=\"button\"\n              className={tab === key ? 'active' : null}\n              onClick={() => tab === key ? setTab(null) : setTab(key)}\n            >\n              {label}\n            </button>\n          ))}\n        </div>\n        <a rel=\"noreferrer\" href=\"https://forms.gle/eYZtTGMCYn15mtF56\" target=\"_blank\">\n          ？\n        </a>\n      </header>\n      <div style={{ padding: '10px 20px' }}>\n\n        {tab === null && <div\n          style={{ height: 210 }}\n        />}\n        {tab === 'original' && <textarea\n          style={{ width: '100%', height: 200 }}\n          value={lyricsStore.original}\n          onChange={(e) => lyricsStore.setOriginal(e.target.value)}\n        />}\n        {tab === 'import' &&\n          <textarea\n            style={{ width: '100%', height: 200 }}\n            value={lyricsStore.replacement}\n            onChange={(e) => lyricsStore.setReplacement(e.target.value)}\n          />\n        }\n        {tab === 'export' && <textarea\n          style={{ width: '100%', height: 200 }}\n          readOnly\n          value={lyricsStore.exportReplacement}\n        />}\n        {tab === 'usual' && <textarea\n          style={{ width: '100%', height: 200 }}\n          placeholder=\"請用半形逗號分隔\"\n          value={lyricsStore.usualWords.join(',')}\n          onChange={(e) => lyricsStore.setUsualWords(e.target.value)}\n        />}\n      </div>\n      <div style={{ padding: '20px' }}>\n        {lyricsStore.transformed.map((line, i) => (\n          <Line key={`line-${i}`} line={line}/>\n        ))}\n      </div>\n\n    </div>\n  );\n}\n\n\nexport default observer(App);\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { observable, action, computed, makeObservable } from \"mobx\";\nimport _ from 'lodash';\n\nconst dummyOriginal = `若這一束吊燈傾瀉下來 或者我 已不會存在\n即使你不愛 亦不需要分開\n\n若這一刻我竟嚴重痴呆 根本不需要被愛\n永遠在床上發夢 餘生都不會再悲哀\n\n人總需要勇敢生存 我還是重新許願\n例如學會 承受失戀\n明年今日 別要再失眠 床褥都改變 如果有幸會面\n或在同伴新婚的盛宴 惶惑地等待你出現\n明年今日 未見你一年 誰捨得改變 離開你六十年\n但願能認得出你的子女 臨別亦聽得到你講再見\n\n人總需要勇敢生存 我還是重新許願\n例如學會 承受失戀\n明年今日 別要再失眠 床褥都改變 如果有幸會面\n或在同伴新婚的盛宴 惶惑地等待你出現\n明年今日 未見你一年 誰捨得改變 離開你六十年\n但願能認得出你的子女 臨別亦聽得到你講再見\n\n在有生的瞬間能遇到你 竟花光所有運氣\n到這日才發現 曾呼吸過空氣`;\n\nclass LyricsStore {\n  original = '';\n  transformed = [];\n\n  replacement = '';\n  transformedReplacement = [];\n\n  data = { characters: {}, words: {}};\n\n  usualWords = [\n    '仍', '常', '還', '而', '如', '然', '時', '和', '才', '或', '亦', '若', '著', '未', '被', '在', '及', '便', '就', '又', '吧', '與', '也', '再', '這', '那', '會', '要', '已', '了', '竟', '當', '不', '可', '只', '因', '先', '請', '的', '嗎', '這'\n  ];\n  constructor() {\n    makeObservable(this, {\n      original: observable,\n      replacement: observable,\n      transformed: observable,\n      transformedReplacement: observable,\n      usualWords: observable,\n      data: observable,\n\n      setUsualWords: action,\n      setData: action,\n\n      exportReplacement: computed,\n      updateReplacement: action,\n\n      setOriginal: action,\n      setReplacement: action,\n    })\n    this.setOriginal(dummyOriginal);\n  }\n  setData(data) {\n    this.data = data;\n    this.setOriginal(dummyOriginal);\n  }\n  setOriginal(val) {\n    this.original = val;\n\n    const lines = val.split('\\n');\n\n    this.transformed = lines.map((line, lineIndex) => ({\n     type: 'line',\n     index: lineIndex,\n     children: line.split(' ').map((sentence, sentenceIndex) => ({\n       type: 'sentence',\n       index: sentenceIndex,\n       children: sentence.split('').reduce((acc, word, wordIndex, arr) => {\n        if (/[a-zA-Z0-9]/g.test(word) && wordIndex && /[a-zA-Z0-9]/g.test(arr[wordIndex - 1])) {\n          acc[acc.length - 1].word += word;\n          return acc;\n        }\n        const d = this.data.characters[word];\n        acc.push({\n          id: [lineIndex, sentenceIndex, wordIndex].join('-'),\n          type: 'word',\n          index: wordIndex,\n          syllable: d && d.syllable + d.tone9,\n          similiarTone: d && d.similiarTone,\n          sentenceIndex,\n          lineIndex,\n          word: word,\n          replacement: this.transformedReplacement.length ? _.get(this.transformedReplacement, `${lineIndex}.children.${sentenceIndex}.children.${wordIndex}.word`, '') : '',\n          replacementSyllable: this.transformedReplacement.length ? _.get(this.transformedReplacement, `${lineIndex}.children.${sentenceIndex}.children.${wordIndex}.syllable`, ''): '',\n          replacementsimiliarTone: this.transformedReplacement.length ? _.get(this.transformedReplacement, `${lineIndex}.children.${sentenceIndex}.children.${wordIndex}.similiarTone`, ''): '',\n\n        });\n        return acc;\n       }, []),\n     }))\n    }));\n  }\n\n\n  setUsualWords(val) {\n    this.usualWords = val.split(',');\n  }\n  setReplacement(val) {\n    this.replacement = val;\n\n    const lines = val.split('\\n');\n    this.transformedReplacement = lines.map((line, lineIndex) => ({\n     type: 'line',\n     index: lineIndex,\n     children: line.split(' ').map((sentence, sentenceIndex) => ({\n       type: 'sentence',\n       index: sentenceIndex,\n       children: sentence.split('').reduce((acc, word, wordIndex, arr) => {\n        if (/[a-zA-Z0-9]/g.test(word) && wordIndex && /[a-zA-Z0-9]/g.test(arr[wordIndex - 1])) {\n          acc[acc.length - 1].word += word;\n          return acc;\n        }\n\n        const d = this.data.characters[word];\n\n        acc.push({\n          id: [lineIndex, sentenceIndex, wordIndex].join('-'),\n          type: 'word',\n          sentenceIndex,\n          lineIndex,\n          index: wordIndex,\n          syllable: d && d.syllable + d.tone9,\n          similiarTone: d && d.similiarTone,\n          word: word,\n        });\n        return acc;\n       }, []),\n     }))\n    }));\n\n    this.setOriginal(this.original);\n  }\n  updateReplacement(wordData, val) {\n    this.transformed[wordData.lineIndex].children[wordData.sentenceIndex].children[wordData.index].replacement = val;\n  }\n\n  get exportReplacement() {\n    return this.transformed\n      .map(line =>\n        line.children\n          .map(sentence =>\n            sentence.children.map(wordData => wordData.replacement).join('')\n          ).join(' ').trim()\n      ).join('\\n').trim();\n  }\n}\n\nexport default LyricsStore;\n","import { observable, action, makeObservable } from \"mobx\";\n\nclass SelectionStore {\n  selections = [];\n  prefixSelection = null;\n  postfixSelection = null;\n\n  constructor() {\n    makeObservable(this, {\n      selections: observable,\n      prefixSelection: observable,\n      postfixSelection: observable,\n\n      setSelections: action,\n      removeSelections: action,\n\n      selectPrefix: action,\n      selectPostfix: action,\n    })\n  }\n  selectPrefix(wordData) {\n    this.selections = [];\n    this.prefixSelection = wordData;\n    this.postfixSelection = null;\n  }\n  selectPostfix(wordData) {\n    this.selections = [];\n    this.postfixSelection = wordData;\n    this.prefixSelection = null;\n  }\n  setSelections(wordDatas) {\n    this.selections = wordDatas;\n    this.prefixSelection = null;\n    this.postfixSelection = null;\n  }\n\n  removeSelections() {\n    this.selections = [];\n    this.prefixSelection = null;\n    this.postfixSelection = null;\n  }\n\n}\n\nexport default SelectionStore;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nimport LyricsStore from './stores/LyricsStore';\nimport SelectionStore from './stores/SelectionStore';\nimport { StoreProvider } from './stores';\n\nconst lyricsStore = new LyricsStore();\nconst selectionStore = new SelectionStore();\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <StoreProvider store={{lyricsStore, selectionStore}}>\n      <App />\n    </StoreProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"selector\":\"ReplacementInput_selector__28D1V\",\"input\":\"ReplacementInput_input__1qHEK\",\"inputContainer\":\"ReplacementInput_inputContainer__1-hmn\",\"btnPostfixSuggestion\":\"ReplacementInput_btnPostfixSuggestion__2ebnr\",\"btnPrefixSuggestion\":\"ReplacementInput_btnPrefixSuggestion__2UHnu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"line\":\"Line_line__1VpsB\",\"separator\":\"Line_separator__1UN_4\"};"],"sourceRoot":""}